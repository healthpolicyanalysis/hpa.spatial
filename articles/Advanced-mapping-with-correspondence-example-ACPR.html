<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Advanced mapping with correspondence example - ACPR • hpa.spatial</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Advanced mapping with correspondence example - ACPR">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hpa.spatial</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.13.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Advanced-mapping-with-correspondence-example-ACPR.html">Advanced mapping with correspondence example - ACPR</a></li>
    <li><a class="dropdown-item" href="../articles/getting-polygons.html">Loading polygons</a></li>
    <li><a class="dropdown-item" href="../articles/mapping-data.html">Mapping data across geographies</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Advanced mapping with correspondence example - ACPR</h1>
            
      

      <div class="d-none name"><code>Advanced-mapping-with-correspondence-example-ACPR.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://healthpolicyanalysis.github.io/hpa.spatial/">hpa.spatial</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="current-problem">Current problem<a class="anchor" aria-label="anchor" href="#current-problem"></a>
</h2>
<ul>
<li>The year is 2024.</li>
<li>We want to map count data from SA2s (2021 edition) to Aged Care
Planning Regions (ACPRs).</li>
<li>There has been population growth in Australia since the 2021 census
population (which the <code>map_with_correspondence()</code> uses by
default for creating correspondence tables).</li>
</ul>
<div class="section level4">
<h4 id="the-plan">The plan<a class="anchor" aria-label="anchor" href="#the-plan"></a>
</h4>
<p>Use <code>map_with_correspondence()</code> but create a new
<code>sf (POINT)</code> object that incorporates the estimated
residential population projections (ERP) from 2023 at the SA2 level.
Since we don’t have mesh block population data from the ERP, this won’t
account for within-SA2-differences in population growth from 2021 to
2023, but it will account for differences in between-SA2-differences in
population growth.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sa2_erp23</span> <span class="co"># use ERP data at SA2 level from ABS &lt;https://www.abs.gov.au/statistics/people/population/regional-population/latest-release#data-downloads&gt;</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,454 × 2</span></span></span>
<span><span class="co">#&gt;    sa2_code_2021   erp</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 101021007      <span style="text-decoration: underline;">4</span>396</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 101021008      <span style="text-decoration: underline;">8</span>483</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 101021009     <span style="text-decoration: underline;">11</span>420</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 101021010      <span style="text-decoration: underline;">5</span>099</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 101021012     <span style="text-decoration: underline;">12</span>873</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 101021610      <span style="text-decoration: underline;">7</span>352</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 101021611     <span style="text-decoration: underline;">17</span>274</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 101031013      <span style="text-decoration: underline;">2</span>468</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 101031014      <span style="text-decoration: underline;">6</span>781</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 101031015      <span style="text-decoration: underline;">3</span>538</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2,444 more rows</span></span></span>
<span></span>
<span><span class="va">mb21_pop</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_mb21_pop.html">get_mb21_pop</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create adjusted MB21 population data for creating correspondence table using ERP data at SA2 level</span></span>
<span><span class="va">adj_mb21_pop</span> <span class="op">&lt;-</span> <span class="va">mb21_pop</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">MB_CODE21</span>, sa2_code_2021 <span class="op">=</span> <span class="va">SA2_CODE21</span>, <span class="va">Person</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># create within-sa2 pop ratios for each mesh block</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>within_sa2_pp <span class="op">=</span> <span class="va">Person</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Person</span><span class="op">)</span>, .by <span class="op">=</span> <span class="va">sa2_code_2021</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># join the ERP (2023) at SA2 level</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">sa2_erp23</span>, by <span class="op">=</span> <span class="st">"sa2_code_2021"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># apply SA2 level ERP to within-sa2 pop ratios to get adjusted pop at mesh block level</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pop23 <span class="op">=</span> <span class="va">erp</span> <span class="op">*</span> <span class="va">within_sa2_pp</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">MB_CODE21</span>, Person <span class="op">=</span> <span class="va">pop23</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># join the POINT geometry back</span></span>
<span>  <span class="op">(</span>\<span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">mb21_pop</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">MB_CODE21</span>, sa2_code_2021 <span class="op">=</span> <span class="va">SA2_CODE21</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">d</span>, by <span class="op">=</span> <span class="st">"MB_CODE21"</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adj_mb21_pop</span></span>
<span><span class="co">#&gt; Simple feature collection with 368172 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 96.82008 ymin: -43.73813 xmax: 167.9959 ymax: -9.143038</span></span>
<span><span class="co">#&gt; Geodetic CRS:  GDA2020</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 368,172 × 4</span></span></span>
<span><span class="co">#&gt;    MB_CODE21   sa2_code_2021             geometry Person</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;POINT [°]&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 10000010000 109011172     (146.9285 -36.08246)  68.2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 10000021000 109011176      (146.9337 -36.0494)   0   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 10000022000 109011176     (146.9301 -36.04838)   5.99</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 10000023000 109011176      (146.9324 -36.0515)   3.99</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 10000024000 109011176     (146.9318 -36.04842)  22.0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 10000040000 109011176     (146.9314 -36.04343)  70.8 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 10000050000 109011176     (146.9521 -36.04567)  63.9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 10000061000 109011172     (146.9494 -36.07781) 143.  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 10000062000 109011172     (146.9445 -36.07819)  76.9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10000063000 109011172     (146.9473 -36.07791) 168.  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 368,162 more rows</span></span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create SA2 count data for mapping</span></span>
<span><span class="va">d_sa2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_polygon.html">get_polygon</a></span><span class="op">(</span><span class="st">"sa22021"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sa2_code_2021</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sa2_code_2021</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">adj_mb21_pop</span><span class="op">$</span><span class="va">sa2_code_2021</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d_sa2</span><span class="op">$</span><span class="va">measure</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">d_sa2</span><span class="op">)</span>, lambda <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># map (and aggregate) the data to ACPR</span></span>
<span><span class="va">mapped_measures</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_data_with_correspondence.html">map_data_with_correspondence</a></span><span class="op">(</span></span>
<span>  .data <span class="op">=</span> <span class="va">d_sa2</span>,</span>
<span>  codes <span class="op">=</span> <span class="va">sa2_code_2021</span>,</span>
<span>  values <span class="op">=</span> <span class="va">measure</span>,</span>
<span>  from_geo <span class="op">=</span> <span class="fu"><a href="../reference/get_polygon.html">get_polygon</a></span><span class="op">(</span><span class="st">"sa22021"</span><span class="op">)</span>,</span>
<span>  to_geo <span class="op">=</span> <span class="fu"><a href="../reference/get_polygon.html">get_polygon</a></span><span class="op">(</span><span class="st">"ACPR"</span><span class="op">)</span>,</span>
<span>  mb_geo <span class="op">=</span> <span class="va">adj_mb21_pop</span>,</span>
<span>  export_fname <span class="op">=</span> <span class="st">"sa22021-to-acpr"</span>,</span>
<span>  value_type <span class="op">=</span> <span class="st">"aggs"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Reading sa22021 file found in /tmp/RtmpAeNJxQ</span></span>
<span><span class="co">#&gt; The data for the Aged Care Planning Regions in Australia (2018 edition) are from here: &lt;https://www.gen-agedcaredata.gov.au/resources/access-data/2020/january/aged-care-planning-region-maps&gt;</span></span>
<span><span class="co">#&gt; Error in get(filename) : object 'CG____' not found</span></span>
<span><span class="co">#&gt; Last resort: making correspondence table using shapes and population at mesh block level</span></span>
<span></span>
<span><span class="co"># map (and aggregate) the ERP to ACPR so that a rate can be calculated</span></span>
<span><span class="va">mapped_pop</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_data_with_correspondence.html">map_data_with_correspondence</a></span><span class="op">(</span></span>
<span>  .data <span class="op">=</span> <span class="va">sa2_erp23</span>,</span>
<span>  codes <span class="op">=</span> <span class="va">sa2_code_2021</span>,</span>
<span>  values <span class="op">=</span> <span class="va">erp</span>,</span>
<span>  from_geo <span class="op">=</span> <span class="fu"><a href="../reference/get_polygon.html">get_polygon</a></span><span class="op">(</span><span class="st">"sa22021"</span><span class="op">)</span>,</span>
<span>  to_geo <span class="op">=</span> <span class="fu"><a href="../reference/get_polygon.html">get_polygon</a></span><span class="op">(</span><span class="st">"ACPR"</span><span class="op">)</span>,</span>
<span>  mb_geo <span class="op">=</span> <span class="va">adj_mb21_pop</span>,</span>
<span>  export_fname <span class="op">=</span> <span class="st">"sa22021-to-acpr"</span>,</span>
<span>  value_type <span class="op">=</span> <span class="st">"aggs"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Reading sa22021 file found in /tmp/RtmpAeNJxQ</span></span>
<span><span class="co">#&gt; The data for the Aged Care Planning Regions in Australia (2018 edition) are from here: &lt;https://www.gen-agedcaredata.gov.au/resources/access-data/2020/january/aged-care-planning-region-maps&gt;</span></span>
<span></span>
<span><span class="va">sa2_rate_poly</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_polygon.html">get_polygon</a></span><span class="op">(</span><span class="st">"sa22021"</span>, crs <span class="op">=</span> <span class="fl">7844</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">d_sa2</span>, by <span class="op">=</span> <span class="st">"sa2_code_2021"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">sa2_erp23</span>, by <span class="op">=</span> <span class="st">"sa2_code_2021"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="va">measure</span> <span class="op">/</span> <span class="va">erp</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reading sa22021 file found in /tmp/RtmpAeNJxQ</span></span>
<span></span>
<span><span class="va">acpr_rate_poly</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_polygon.html">get_polygon</a></span><span class="op">(</span><span class="st">"ACPR"</span>, crs <span class="op">=</span> <span class="fl">7844</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">mapped_measures</span>, by <span class="op">=</span> <span class="st">"acpr_code"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">mapped_pop</span>, by <span class="op">=</span> <span class="st">"acpr_code"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="va">measure</span> <span class="op">/</span> <span class="va">erp</span><span class="op">)</span></span>
<span><span class="co">#&gt; The data for the Aged Care Planning Regions in Australia (2018 edition) are from here: &lt;https://www.gen-agedcaredata.gov.au/resources/access-data/2020/january/aged-care-planning-region-maps&gt;</span></span>
<span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sa2_rate_poly</span>, <span class="va">rate</span>, <span class="va">erp</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>geo <span class="op">=</span> <span class="st">"SA2 (2021)"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">acpr_rate_poly</span>, <span class="va">rate</span>, <span class="va">erp</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>geo <span class="op">=</span> <span class="st">"ACPR (2018)"</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">erp</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">rate</span><span class="op">)</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html" class="external-link">scale_fill_continuous</a></span><span class="op">(</span>trans <span class="op">=</span> <span class="st">"log10"</span>, labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_comma</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">geo</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Rate"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-mapping-with-correspondence-example-ACPR_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rex Parsons.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
