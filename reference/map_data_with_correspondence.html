<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Map data between editions using correspondence tables from the ABS. — map_data_with_correspondence • hpa.spatial</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Map data between editions using correspondence tables from the ABS. — map_data_with_correspondence"><meta name="description" content="Map data between editions using correspondence tables from the ABS."><meta property="og:description" content="Map data between editions using correspondence tables from the ABS."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hpa.spatial</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.11.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/getting-polygons.html">Loading polygons</a></li>
    <li><a class="dropdown-item" href="../articles/mapping-data.html">Mapping data across geographies</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Map data between editions using correspondence tables from the ABS.</h1>

      <div class="d-none name"><code>map_data_with_correspondence.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Map data between editions using correspondence tables from the ABS.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">map_data_with_correspondence</span><span class="op">(</span></span>
<span>  .data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">codes</span>,</span>
<span>  <span class="va">values</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  from_area <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  from_year <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  from_geo <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  to_area <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  to_year <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  to_geo <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  correspondence_tbl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mb_geo <span class="op">=</span> <span class="fu"><a href="get_mb21_pop.html">get_mb21_pop</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  value_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"units"</span>, <span class="st">"aggs"</span><span class="op">)</span>,</span>
<span>  export_fname <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  round <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quiet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"hpa.spatial.quiet"</span>, <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--data">.data<a class="anchor" aria-label="anchor" href="#arg--data"></a></dt>
<dd><p>A <code>data.frame</code>(-like) object. Can be passed if codes,
values or groups are passed by reference (like in <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate()</a></code>).</p></dd>


<dt id="arg-codes">codes<a class="anchor" aria-label="anchor" href="#arg-codes"></a></dt>
<dd><p>Codes representing locations relevant to the <code>from_area</code>.
SA1 or SA2, for example.</p></dd>


<dt id="arg-values">values<a class="anchor" aria-label="anchor" href="#arg-values"></a></dt>
<dd><p>Values associated with codes to be allocated to newly mapped
codes.</p></dd>


<dt id="arg-groups">groups<a class="anchor" aria-label="anchor" href="#arg-groups"></a></dt>
<dd><p>Values associated with codes/values specifying a grouping
structure. For example, if there are codes/values for several age groups,
then groups will be the grouping variable for the age group associated with
the code and value of the same position. Defaults to <code>NULL</code> (no
grouping).</p></dd>


<dt id="arg-from-area">from_area<a class="anchor" aria-label="anchor" href="#arg-from-area"></a></dt>
<dd><p>The area you want to correspond FROM (ie the areas your data
are currently in). For example: "sa1", "sa2, "sa3", "sa4".</p></dd>


<dt id="arg-from-year">from_year<a class="anchor" aria-label="anchor" href="#arg-from-year"></a></dt>
<dd><p>The year you want to correspond FROM. For example: 2011,
2016.</p></dd>


<dt id="arg-from-geo">from_geo<a class="anchor" aria-label="anchor" href="#arg-from-geo"></a></dt>
<dd><p>The FROM polygon geography. Helpful if it is not available
using <code>from_year</code> and <code>from_area</code> in <code>get_polygon</code>.</p></dd>


<dt id="arg-to-area">to_area<a class="anchor" aria-label="anchor" href="#arg-to-area"></a></dt>
<dd><p>The area you want to correspond TO (ie the areas you want your
data to be in).</p></dd>


<dt id="arg-to-year">to_year<a class="anchor" aria-label="anchor" href="#arg-to-year"></a></dt>
<dd><p>The year you want to correspond TO.</p></dd>


<dt id="arg-to-geo">to_geo<a class="anchor" aria-label="anchor" href="#arg-to-geo"></a></dt>
<dd><p>The TO polygon geography. Helpful if it is not available
using <code>to_year</code> and <code>to_area</code> in <code>get_polygon</code>.</p></dd>


<dt id="arg-correspondence-tbl">correspondence_tbl<a class="anchor" aria-label="anchor" href="#arg-correspondence-tbl"></a></dt>
<dd><p>A correspondence table to be used to map values
between code sets. It should contain 3 columns: (1) code set FROM which
values are being mapped, (2) code set TO which values are being mapped, and
(3) a column named "ratio" containing the proportion/probability of the
value(s) being mapped between the from- and to- code pair (row). Defaults to
<code>NULL</code>, in which case it will attempt to get the correspondence table
from the ABS and, if not available, it will create a correspondence table
based on the overlap of the shapes and the residential population in the
intersection (uses <code>mb_geo</code> argument).</p></dd>


<dt id="arg-mb-geo">mb_geo<a class="anchor" aria-label="anchor" href="#arg-mb-geo"></a></dt>
<dd><p>An <code>{sf}</code> POINT object where the points are the centroids
of a small area (intended to be mesh blocks but can be any other space that's
small enough to be useful. Should also include a column, <code>Person</code>,
with the population within that area. Defaults to use Mesh Blocks (2021) and
with 2021 census data. See <code><a href="get_mb21_pop.html">get_mb21_pop()</a></code>.</p></dd>


<dt id="arg-value-type">value_type<a class="anchor" aria-label="anchor" href="#arg-value-type"></a></dt>
<dd><p>Whether the data are unit level or aggregate level data.
Unit level data is randomly allocated to new locations based on proportions
in the correspondence table, aggregate data is dispersed based on the
proportion across the (potentially multiple) mapped codes.</p></dd>


<dt id="arg-export-fname">export_fname<a class="anchor" aria-label="anchor" href="#arg-export-fname"></a></dt>
<dd><p>The file name for the saved correspondence table file
(applicable if <code>from_geo</code>) and <code>to_geo</code> are used instead of areas
and years).</p></dd>


<dt id="arg-round">round<a class="anchor" aria-label="anchor" href="#arg-round"></a></dt>
<dd><p>Whether or not to round the resulting mapped values to be whole
numbers (maybe be useful when mapping count, aggregate values which may
otherwise return decimal values in the mapped areas).</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>A random seed (integer). May be useful for ensuring mappings of
unit level data are reproducible (as these use the mapping probabilities
for randomly allocating observations to the new geographies and may be
different between runs with the same data/inputs).</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>whether to be quiet about warnings. Set package level quiet-ness
with <code>options(hpa.spatial.quiet = TRUE)</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>data.frame</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">map_data_with_correspondence</span><span class="op">(</span></span></span>
<span class="r-in"><span>  codes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">107011130</span>, <span class="fl">107041149</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  from_area <span class="op">=</span> <span class="st">"sa2"</span>,</span></span>
<span class="r-in"><span>  from_year <span class="op">=</span> <span class="fl">2011</span>,</span></span>
<span class="r-in"><span>  to_area <span class="op">=</span> <span class="st">"sa2"</span>,</span></span>
<span class="r-in"><span>  to_year <span class="op">=</span> <span class="fl">2016</span>,</span></span>
<span class="r-in"><span>  value_type <span class="op">=</span> <span class="st">"units"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   SA2_MAINCODE_2016 values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 107011545             10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 107041548             10</span>
<span class="r-in"><span><span class="fu">map_data_with_correspondence</span><span class="op">(</span></span></span>
<span class="r-in"><span>  codes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">107011130</span>, <span class="fl">107041149</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  from_area <span class="op">=</span> <span class="st">"sa2"</span>,</span></span>
<span class="r-in"><span>  from_year <span class="op">=</span> <span class="fl">2011</span>,</span></span>
<span class="r-in"><span>  to_area <span class="op">=</span> <span class="st">"sa2"</span>,</span></span>
<span class="r-in"><span>  to_year <span class="op">=</span> <span class="fl">2016</span>,</span></span>
<span class="r-in"><span>  value_type <span class="op">=</span> <span class="st">"aggs"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 5 × 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   SA2_MAINCODE_2016 values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 107011545           4.82</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 107011546           3.62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 107011547           1.57</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 107041548           4.49</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 107041549           5.51</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rex Parsons.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

